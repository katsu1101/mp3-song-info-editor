(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,25239,e=>{e.v({backdrop:"AppShell-module__WVLZsa__backdrop",body:"AppShell-module__WVLZsa__body",drawerClose:"AppShell-module__WVLZsa__drawerClose",drawerHeader:"AppShell-module__WVLZsa__drawerHeader",drawerSub:"AppShell-module__WVLZsa__drawerSub",drawerTitle:"AppShell-module__WVLZsa__drawerTitle",header:"AppShell-module__WVLZsa__header",headerContent:"AppShell-module__WVLZsa__headerContent",headerInner:"AppShell-module__WVLZsa__headerInner",miniPlayerBar:"AppShell-module__WVLZsa__miniPlayerBar",playerInner:"AppShell-module__WVLZsa__playerInner",playerPane:"AppShell-module__WVLZsa__playerPane",playerSheet:"AppShell-module__WVLZsa__playerSheet",root:"AppShell-module__WVLZsa__root",scrollPane:"AppShell-module__WVLZsa__scrollPane",sheetBackdrop:"AppShell-module__WVLZsa__sheetBackdrop",sheetBody:"AppShell-module__WVLZsa__sheetBody",sheetClose:"AppShell-module__WVLZsa__sheetClose",sheetHandle:"AppShell-module__WVLZsa__sheetHandle",sheetHeader:"AppShell-module__WVLZsa__sheetHeader",sidebarPane:"AppShell-module__WVLZsa__sidebarPane",sidebarToggle:"AppShell-module__WVLZsa__sidebarToggle"})},24207,(e,t,r)=>{"use strict";function i({widthInt:e,heightInt:t,blurWidth:r,blurHeight:i,blurDataURL:l,objectFit:n}){let a=r?40*r:e,o=i?40*i:t,s=a&&o?`viewBox='0 0 ${a} ${o}'`:"";return`%3Csvg xmlns='http://www.w3.org/2000/svg' ${s}%3E%3Cfilter id='b' color-interpolation-filters='sRGB'%3E%3CfeGaussianBlur stdDeviation='20'/%3E%3CfeColorMatrix values='1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 100 -1' result='s'/%3E%3CfeFlood x='0' y='0' width='100%25' height='100%25'/%3E%3CfeComposite operator='out' in='s'/%3E%3CfeComposite in2='SourceGraphic'/%3E%3CfeGaussianBlur stdDeviation='20'/%3E%3C/filter%3E%3Cimage width='100%25' height='100%25' x='0' y='0' preserveAspectRatio='${s?"none":"contain"===n?"xMidYMid":"cover"===n?"xMidYMid slice":"none"}' style='filter: url(%23b);' href='${l}'/%3E%3C/svg%3E`}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"getImageBlurSvg",{enumerable:!0,get:function(){return i}})},2965,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i={VALID_LOADERS:function(){return n},imageConfigDefault:function(){return a}};for(var l in i)Object.defineProperty(r,l,{enumerable:!0,get:i[l]});let n=["default","imgix","cloudinary","akamai","custom"],a={deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[32,48,64,96,128,256,384],path:"/_next/image",loader:"default",loaderFile:"",domains:[],disableStaticImages:!1,minimumCacheTTL:14400,formats:["image/webp"],maximumRedirects:3,dangerouslyAllowLocalIP:!1,dangerouslyAllowSVG:!1,contentSecurityPolicy:"script-src 'none'; frame-src 'none'; sandbox;",contentDispositionType:"attachment",localPatterns:void 0,remotePatterns:[],qualities:[75],unoptimized:!1}},1852,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"getImgProps",{enumerable:!0,get:function(){return d}}),e.r(43946);let i=e.r(40824),l=e.r(24207),n=e.r(2965),a=["-moz-initial","fill","none","scale-down",void 0];function o(e){return void 0!==e.default}function s(e){return void 0===e?e:"number"==typeof e?Number.isFinite(e)?e:NaN:"string"==typeof e&&/^[0-9]+$/.test(e)?parseInt(e,10):NaN}function d({src:e,sizes:t,unoptimized:r=!1,priority:d=!1,preload:c=!1,loading:u,className:p,quality:f,width:h,height:g,fill:m=!1,style:y,overrideSrc:b,onLoad:v,onLoadingComplete:x,placeholder:w="empty",blurDataURL:j,fetchPriority:_,decoding:S="async",layout:C,objectFit:P,objectPosition:k,lazyBoundary:R,lazyRoot:E,...A},L){var O;let I,N,W,{imgConf:z,showAltText:M,blurComplete:T,defaultLoader:$}=L,D=z||n.imageConfigDefault;if("allSizes"in D)I=D;else{let e=[...D.deviceSizes,...D.imageSizes].sort((e,t)=>e-t),t=D.deviceSizes.sort((e,t)=>e-t),r=D.qualities?.sort((e,t)=>e-t);I={...D,allSizes:e,deviceSizes:t,qualities:r}}if(void 0===$)throw Object.defineProperty(Error("images.loaderFile detected but the file is missing default export.\nRead more: https://nextjs.org/docs/messages/invalid-images-config"),"__NEXT_ERROR_CODE",{value:"E163",enumerable:!1,configurable:!0});let B=A.loader||$;delete A.loader,delete A.srcSet;let U="__next_img_default"in B;if(U){if("custom"===I.loader)throw Object.defineProperty(Error(`Image with src "${e}" is missing "loader" prop.
Read more: https://nextjs.org/docs/messages/next-image-missing-loader`),"__NEXT_ERROR_CODE",{value:"E252",enumerable:!1,configurable:!0})}else{let e=B;B=t=>{let{config:r,...i}=t;return e(i)}}if(C){"fill"===C&&(m=!0);let e={intrinsic:{maxWidth:"100%",height:"auto"},responsive:{width:"100%",height:"auto"}}[C];e&&(y={...y,...e});let r={responsive:"100vw",fill:"100vw"}[C];r&&!t&&(t=r)}let F="",H=s(h),V=s(g);if((O=e)&&"object"==typeof O&&(o(O)||void 0!==O.src)){let t=o(e)?e.default:e;if(!t.src)throw Object.defineProperty(Error(`An object should only be passed to the image component src parameter if it comes from a static image import. It must include src. Received ${JSON.stringify(t)}`),"__NEXT_ERROR_CODE",{value:"E460",enumerable:!1,configurable:!0});if(!t.height||!t.width)throw Object.defineProperty(Error(`An object should only be passed to the image component src parameter if it comes from a static image import. It must include height and width. Received ${JSON.stringify(t)}`),"__NEXT_ERROR_CODE",{value:"E48",enumerable:!1,configurable:!0});if(N=t.blurWidth,W=t.blurHeight,j=j||t.blurDataURL,F=t.src,!m)if(H||V){if(H&&!V){let e=H/t.width;V=Math.round(t.height*e)}else if(!H&&V){let e=V/t.height;H=Math.round(t.width*e)}}else H=t.width,V=t.height}let Z=!d&&!c&&("lazy"===u||void 0===u);(!(e="string"==typeof e?e:F)||e.startsWith("data:")||e.startsWith("blob:"))&&(r=!0,Z=!1),I.unoptimized&&(r=!0),U&&!I.dangerouslyAllowSVG&&e.split("?",1)[0].endsWith(".svg")&&(r=!0);let q=s(f),K=Object.assign(m?{position:"absolute",height:"100%",width:"100%",left:0,top:0,right:0,bottom:0,objectFit:P,objectPosition:k}:{},M?{}:{color:"transparent"},y),G=T||"empty"===w?null:"blur"===w?`url("data:image/svg+xml;charset=utf-8,${(0,l.getImageBlurSvg)({widthInt:H,heightInt:V,blurWidth:N,blurHeight:W,blurDataURL:j||"",objectFit:K.objectFit})}")`:`url("${w}")`,X=a.includes(K.objectFit)?"fill"===K.objectFit?"100% 100%":"cover":K.objectFit,Y=G?{backgroundSize:X,backgroundPosition:K.objectPosition||"50% 50%",backgroundRepeat:"no-repeat",backgroundImage:G}:{},J=function({config:e,src:t,unoptimized:r,width:l,quality:n,sizes:a,loader:o}){if(r){let e=(0,i.getDeploymentId)();if(t.startsWith("/")&&!t.startsWith("//")&&e){let r=t.includes("?")?"&":"?";t=`${t}${r}dpl=${e}`}return{src:t,srcSet:void 0,sizes:void 0}}let{widths:s,kind:d}=function({deviceSizes:e,allSizes:t},r,i){if(i){let r=/(^|\s)(1?\d?\d)vw/g,l=[];for(let e;e=r.exec(i);)l.push(parseInt(e[2]));if(l.length){let r=.01*Math.min(...l);return{widths:t.filter(t=>t>=e[0]*r),kind:"w"}}return{widths:t,kind:"w"}}return"number"!=typeof r?{widths:e,kind:"w"}:{widths:[...new Set([r,2*r].map(e=>t.find(t=>t>=e)||t[t.length-1]))],kind:"x"}}(e,l,a),c=s.length-1;return{sizes:a||"w"!==d?a:"100vw",srcSet:s.map((r,i)=>`${o({config:e,src:t,quality:n,width:r})} ${"w"===d?r:i+1}${d}`).join(", "),src:o({config:e,src:t,quality:n,width:s[c]})}}({config:I,src:e,unoptimized:r,width:H,quality:q,sizes:t,loader:B}),Q=Z?"lazy":u;return{props:{...A,loading:Q,fetchPriority:_,width:H,height:V,decoding:S,className:p,style:{...K,...Y},sizes:J.sizes,srcSet:J.srcSet,src:b||J.src},meta:{unoptimized:r,preload:c||d,placeholder:w,fill:m}}}},31324,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"default",{enumerable:!0,get:function(){return o}});let i=e.r(778),l="undefined"==typeof window,n=l?()=>{}:i.useLayoutEffect,a=l?()=>{}:i.useEffect;function o(e){let{headManager:t,reduceComponentsToState:r}=e;function o(){if(t&&t.mountedInstances){let e=i.Children.toArray(Array.from(t.mountedInstances).filter(Boolean));t.updateHead(r(e))}}return l&&(t?.mountedInstances?.add(e.children),o()),n(()=>(t?.mountedInstances?.add(e.children),()=>{t?.mountedInstances?.delete(e.children)})),n(()=>(t&&(t._pendingUpdate=o),()=>{t&&(t._pendingUpdate=o)})),a(()=>(t&&t._pendingUpdate&&(t._pendingUpdate(),t._pendingUpdate=null),()=>{t&&t._pendingUpdate&&(t._pendingUpdate(),t._pendingUpdate=null)})),null}},93529,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i={default:function(){return g},defaultHead:function(){return u}};for(var l in i)Object.defineProperty(r,l,{enumerable:!0,get:i[l]});let n=e.r(81258),a=e.r(44066),o=e.r(80506),s=a._(e.r(778)),d=n._(e.r(31324)),c=e.r(37e3);function u(){return[(0,o.jsx)("meta",{charSet:"utf-8"},"charset"),(0,o.jsx)("meta",{name:"viewport",content:"width=device-width"},"viewport")]}function p(e,t){return"string"==typeof t||"number"==typeof t?e:t.type===s.default.Fragment?e.concat(s.default.Children.toArray(t.props.children).reduce((e,t)=>"string"==typeof t||"number"==typeof t?e:e.concat(t),[])):e.concat(t)}e.r(43946);let f=["name","httpEquiv","charSet","itemProp"];function h(e){let t,r,i,l;return e.reduce(p,[]).reverse().concat(u().reverse()).filter((t=new Set,r=new Set,i=new Set,l={},e=>{let n=!0,a=!1;if(e.key&&"number"!=typeof e.key&&e.key.indexOf("$")>0){a=!0;let r=e.key.slice(e.key.indexOf("$")+1);t.has(r)?n=!1:t.add(r)}switch(e.type){case"title":case"base":r.has(e.type)?n=!1:r.add(e.type);break;case"meta":for(let t=0,r=f.length;t<r;t++){let r=f[t];if(e.props.hasOwnProperty(r))if("charSet"===r)i.has(r)?n=!1:i.add(r);else{let t=e.props[r],i=l[r]||new Set;("name"!==r||!a)&&i.has(t)?n=!1:(i.add(t),l[r]=i)}}}return n})).reverse().map((e,t)=>{let r=e.key||t;return s.default.cloneElement(e,{key:r})})}let g=function({children:e}){let t=(0,s.useContext)(c.HeadManagerContext);return(0,o.jsx)(d.default,{reduceComponentsToState:h,headManager:t,children:e})};("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},71807,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"ImageConfigContext",{enumerable:!0,get:function(){return n}});let i=e.r(81258)._(e.r(778)),l=e.r(2965),n=i.default.createContext(l.imageConfigDefault)},94220,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"RouterContext",{enumerable:!0,get:function(){return i}});let i=e.r(81258)._(e.r(778)).default.createContext(null)},83230,(e,t,r)=>{"use strict";function i(e,t){let r=e||75;return t?.qualities?.length?t.qualities.reduce((e,t)=>Math.abs(t-r)<Math.abs(e-r)?t:e,0):r}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"findClosestQuality",{enumerable:!0,get:function(){return i}})},5656,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"default",{enumerable:!0,get:function(){return a}});let i=e.r(83230),l=e.r(40824);function n({config:e,src:t,width:r,quality:n}){if(t.startsWith("/")&&t.includes("?")&&e.localPatterns?.length===1&&"**"===e.localPatterns[0].pathname&&""===e.localPatterns[0].search)throw Object.defineProperty(Error(`Image with src "${t}" is using a query string which is not configured in images.localPatterns.
Read more: https://nextjs.org/docs/messages/next-image-unconfigured-localpatterns`),"__NEXT_ERROR_CODE",{value:"E871",enumerable:!1,configurable:!0});let a=(0,i.findClosestQuality)(n,e),o=(0,l.getDeploymentId)();return`${e.path}?url=${encodeURIComponent(t)}&w=${r}&q=${a}${t.startsWith("/")&&o?`&dpl=${o}`:""}`}n.__next_img_default=!0;let a=n},4357,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"useMergedRef",{enumerable:!0,get:function(){return l}});let i=e.r(778);function l(e,t){let r=(0,i.useRef)(null),l=(0,i.useRef)(null);return(0,i.useCallback)(i=>{if(null===i){let e=r.current;e&&(r.current=null,e());let t=l.current;t&&(l.current=null,t())}else e&&(r.current=n(e,i)),t&&(l.current=n(t,i))},[e,t])}function n(e,t){if("function"!=typeof e)return e.current=t,()=>{e.current=null};{let r=e(t);return"function"==typeof r?r:()=>e(null)}}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},72039,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"Image",{enumerable:!0,get:function(){return x}});let i=e.r(81258),l=e.r(44066),n=e.r(80506),a=l._(e.r(778)),o=i._(e.r(50919)),s=i._(e.r(93529)),d=e.r(1852),c=e.r(2965),u=e.r(71807);e.r(43946);let p=e.r(94220),f=i._(e.r(5656)),h=e.r(4357),g={deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[32,48,64,96,128,256,384],qualities:[75],path:"/mp3-song-info-editor/_next/image/",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!0};function m(e,t,r,i,l,n,a){let o=e?.src;e&&e["data-loaded-src"]!==o&&(e["data-loaded-src"]=o,("decode"in e?e.decode():Promise.resolve()).catch(()=>{}).then(()=>{if(e.parentElement&&e.isConnected){if("empty"!==t&&l(!0),r?.current){let t=new Event("load");Object.defineProperty(t,"target",{writable:!1,value:e});let i=!1,l=!1;r.current({...t,nativeEvent:t,currentTarget:e,target:e,isDefaultPrevented:()=>i,isPropagationStopped:()=>l,persist:()=>{},preventDefault:()=>{i=!0,t.preventDefault()},stopPropagation:()=>{l=!0,t.stopPropagation()}})}i?.current&&i.current(e)}}))}function y(e){return a.use?{fetchPriority:e}:{fetchpriority:e}}"undefined"==typeof window&&(globalThis.__NEXT_IMAGE_IMPORTED=!0);let b=(0,a.forwardRef)(({src:e,srcSet:t,sizes:r,height:i,width:l,decoding:o,className:s,style:d,fetchPriority:c,placeholder:u,loading:p,unoptimized:f,fill:g,onLoadRef:b,onLoadingCompleteRef:v,setBlurComplete:x,setShowAltText:w,sizesInput:j,onLoad:_,onError:S,...C},P)=>{let k=(0,a.useCallback)(e=>{e&&(S&&(e.src=e.src),e.complete&&m(e,u,b,v,x,f,j))},[e,u,b,v,x,S,f,j]),R=(0,h.useMergedRef)(P,k);return(0,n.jsx)("img",{...C,...y(c),loading:p,width:l,height:i,decoding:o,"data-nimg":g?"fill":"1",className:s,style:d,sizes:r,srcSet:t,src:e,ref:R,onLoad:e=>{m(e.currentTarget,u,b,v,x,f,j)},onError:e=>{w(!0),"empty"!==u&&x(!0),S&&S(e)}})});function v({isAppRouter:e,imgAttributes:t}){let r={as:"image",imageSrcSet:t.srcSet,imageSizes:t.sizes,crossOrigin:t.crossOrigin,referrerPolicy:t.referrerPolicy,...y(t.fetchPriority)};return e&&o.default.preload?(o.default.preload(t.src,r),null):(0,n.jsx)(s.default,{children:(0,n.jsx)("link",{rel:"preload",href:t.srcSet?void 0:t.src,...r},"__nimg-"+t.src+t.srcSet+t.sizes)})}let x=(0,a.forwardRef)((e,t)=>{let r=(0,a.useContext)(p.RouterContext),i=(0,a.useContext)(u.ImageConfigContext),l=(0,a.useMemo)(()=>{let e=g||i||c.imageConfigDefault,t=[...e.deviceSizes,...e.imageSizes].sort((e,t)=>e-t),r=e.deviceSizes.sort((e,t)=>e-t),l=e.qualities?.sort((e,t)=>e-t);return{...e,allSizes:t,deviceSizes:r,qualities:l,localPatterns:"undefined"==typeof window?i?.localPatterns:e.localPatterns}},[i]),{onLoad:o,onLoadingComplete:s}=e,h=(0,a.useRef)(o);(0,a.useEffect)(()=>{h.current=o},[o]);let m=(0,a.useRef)(s);(0,a.useEffect)(()=>{m.current=s},[s]);let[y,x]=(0,a.useState)(!1),[w,j]=(0,a.useState)(!1),{props:_,meta:S}=(0,d.getImgProps)(e,{defaultLoader:f.default,imgConf:l,blurComplete:y,showAltText:w});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(b,{..._,unoptimized:S.unoptimized,placeholder:S.placeholder,fill:S.fill,onLoadRef:h,onLoadingCompleteRef:m,setBlurComplete:x,setShowAltText:j,sizesInput:e.sizes,ref:t}),S.preload?(0,n.jsx)(v,{isAppRouter:!r,imgAttributes:_}):null]})});("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},58956,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i={default:function(){return c},getImageProps:function(){return d}};for(var l in i)Object.defineProperty(r,l,{enumerable:!0,get:i[l]});let n=e.r(81258),a=e.r(1852),o=e.r(72039),s=n._(e.r(5656));function d(e){let{props:t}=(0,a.getImgProps)(e,{defaultLoader:s.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[32,48,64,96,128,256,384],qualities:[75],path:"/mp3-song-info-editor/_next/image/",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!0}});for(let[e,r]of Object.entries(t))void 0===r&&delete t[e];return{props:t}}let c=o.Image},59325,(e,t,r)=>{t.exports=e.r(58956)},18613,e=>{e.v({isPaused:"NowPlayingRing-module__Cm4CVq__isPaused",npRing:"NowPlayingRing-module__Cm4CVq__npRing",npRing1:"NowPlayingRing-module__Cm4CVq__npRing1",npRing2:"NowPlayingRing-module__Cm4CVq__npRing2"})},52683,e=>{"use strict";var t=e.i(80506),r=e.i(778),i=e.i(25239);function l({header:e,sidebar:l,main:n,renderPlayer:a}){let o=(0,r.useId)(),[s,d]=(0,r.useState)(!1),[c,u]=(0,r.useState)(!1),p=(0,r.useCallback)(()=>d(!1),[]),f=(0,r.useCallback)(()=>d(e=>!e),[]),h=(0,r.useCallback)(()=>u(!0),[]),g=(0,r.useCallback)(()=>u(!1),[]);(0,r.useEffect)(()=>{let e=e=>{if("Escape"===e.key){if(c)return g();if(s)return p()}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[c,s,g,p]),(0,r.useEffect)(()=>{if(!(c||s))return;let e=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=e}},[c,s]);let m=(0,r.useMemo)(()=>s?"true":"false",[s]),y=(0,r.useMemo)(()=>c?"true":"false",[c]);return(0,t.jsxs)("div",{className:i.default.root,children:[(0,t.jsx)("div",{className:i.default.header,children:(0,t.jsxs)("div",{className:i.default.headerInner,children:[(0,t.jsx)("button",{type:"button",className:i.default.sidebarToggle,"aria-controls":o,"aria-expanded":s,onClick:f,children:"☰ メニュー"}),(0,t.jsx)("div",{className:i.default.headerContent,children:e})]})}),(0,t.jsx)("div",{className:i.default.backdrop,"data-open":m,onClick:p,"aria-hidden":"true"}),(0,t.jsx)("div",{className:i.default.sheetBackdrop,"data-open":y,onClick:g,"aria-hidden":"true"}),(0,t.jsxs)("div",{className:i.default.body,children:[(0,t.jsxs)("aside",{id:"sidebar-drawer",className:i.default.sidebarPane,"data-open":s?"true":"false",children:[(0,t.jsxs)("div",{className:i.default.drawerHeader,children:[(0,t.jsx)("div",{children:(0,t.jsx)("div",{className:i.default.drawerTitle,children:"メニュー"})}),(0,t.jsx)("button",{type:"button",className:i.default.drawerClose,onClick:()=>d(!1),"aria-label":"メニューを閉じる",children:"✕"})]}),l]}),(0,t.jsx)("main",{className:`${i.default.scrollPane} ${i.default.mainPane} scrollbar`,children:n}),(0,t.jsx)("aside",{className:`${i.default.scrollPane} ${i.default.playerPane} scrollbar`,children:(0,t.jsx)("div",{className:i.default.playerInner,children:a("full")})})]}),(0,t.jsx)("div",{className:i.default.miniPlayerBar,role:"button",tabIndex:0,onClick:h,onKeyDown:e=>{"Enter"===e.key&&h()},children:a("mini")}),(0,t.jsxs)("section",{className:i.default.playerSheet,"data-open":y,role:"dialog","aria-modal":"true",children:[(0,t.jsxs)("div",{className:i.default.sheetHeader,children:[(0,t.jsx)("div",{className:i.default.sheetHandle}),(0,t.jsx)("button",{type:"button",className:i.default.sheetClose,onClick:g,children:"閉じる"})]}),(0,t.jsx)("div",{className:i.default.sheetBody,children:a("full")})]})]})}var n=e.i(59325);let a=e=>{let t=e.split("/").filter(Boolean);return t[t.length-1]??e};function o(e){let i,{nowPlayingID:l,trackViews:o,audioRef:u,playActions:p,isPlaying:f}=e,h=(0,r.useMemo)(()=>l?o.find(e=>e.item.id===l)??null:null,[l,o]),g=h?.displayTitle??"",m=h?.item.path,y=m?a(m):"—",b=m?(i=m.split("/").filter(Boolean)).length<=1?"":i.slice(0,-1).join("/"):"",v=!!h?.item,x=async()=>{if(!v)return;let e=u.current;if(e){if(e.paused||e.ended){try{await e.play()}catch{}return}e.pause()}};return"mini"===(e.variant??"full")?(0,t.jsxs)("div",{style:{height:"100%",width:"100%",display:"flex",alignItems:"stretch",minWidth:0},children:[(0,t.jsx)("div",{style:{height:"100%",aspectRatio:"1 / 1",borderRight:"1px solid var(--panel-border)",background:"var(--panel)",display:"grid",placeItems:"center"},children:h?.coverUrl?(0,t.jsx)(n.default,{src:h.coverUrl,alt:"",width:256,height:256,unoptimized:!0,style:{width:"100%",height:"100%",objectFit:"cover"}}):(0,t.jsx)("span",{style:{fontSize:11,opacity:.6},children:"No Art"})}),(0,t.jsxs)("div",{style:{flex:1,minWidth:0,display:"flex",flexDirection:"column",justifyContent:"space-between",padding:"10px 12px",gap:8},children:[(0,t.jsx)("div",{style:{fontSize:14,fontWeight:900,lineHeight:1.2,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:"var(--foreground)"},title:g,children:g}),(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,justifyContent:"flex-end"},children:[(0,t.jsx)("button",{type:"button",onClick:e=>{e.stopPropagation(),p.playPrev()},disabled:!v,style:c(!v),title:"前へ",children:"⏮"}),(0,t.jsx)("button",{type:"button",onClick:e=>{e.stopPropagation(),x()},disabled:!v,style:c(!v),title:f?"一時停止":"再生",children:f?"⏸":"▶"}),(0,t.jsx)("button",{type:"button",onClick:e=>{e.stopPropagation(),p.playNext()},disabled:!v,style:c(!v),title:"次へ",children:"⏭"})]})]})]}):(0,t.jsxs)("section",{style:{marginTop:12,padding:12,borderRadius:16,border:"1px solid var(--panel-border)",background:"var(--panel)",overflowX:"hidden",maxWidth:"100%",color:"var(--foreground)"},children:[(0,t.jsx)("div",{style:{display:"grid",placeItems:"center"},children:(0,t.jsx)("div",{style:{width:"100%",maxWidth:280,aspectRatio:"1 / 1",borderRadius:18,overflow:"hidden",border:"1px solid var(--panel-border)",background:"var(--panel)",display:"grid",placeItems:"center"},children:h?.coverUrl?(0,t.jsx)(n.default,{src:h.coverUrl,alt:"",width:280,height:280,unoptimized:!0,style:{width:"100%",height:"100%",objectFit:"cover"}}):(0,t.jsx)("span",{style:{fontSize:12,opacity:.7},children:"No Art"})})}),(0,t.jsxs)("div",{style:{marginTop:10,display:"flex",alignItems:"center",gap:10,minWidth:0},children:[(0,t.jsx)("div",{style:{minWidth:0,fontSize:16,fontWeight:900,lineHeight:1.2,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},title:g,children:g}),(0,t.jsxs)("div",{style:{marginLeft:"auto",display:"flex",alignItems:"center",gap:10},children:[(0,t.jsx)("button",{type:"button",onClick:()=>void p.playPrev(),disabled:!v,style:d(!v),title:"前へ",children:"⏮"}),(0,t.jsx)("button",{type:"button",onClick:()=>void x(),disabled:!v,style:d(!v),title:f?"一時停止":"再生",children:f?"⏸":"▶"}),(0,t.jsx)("button",{type:"button",onClick:()=>void p.playNext(),disabled:!v,style:d(!v),title:"次へ",children:"⏭"})]})]}),(0,t.jsx)("div",{style:{marginTop:10},children:(0,t.jsx)("audio",{ref:u,controls:!0,preload:"none",style:{width:"100%"}})}),(0,t.jsxs)("div",{style:{marginTop:12,display:"grid",gap:6},children:[(0,t.jsx)(s,{label:"年月/順",value:h?.orderLabel??"—"}),(0,t.jsx)(s,{label:"原曲",value:h?.originalArtist??"—"}),(0,t.jsx)(s,{label:"ファイル",value:y}),b?(0,t.jsx)(s,{label:"フォルダ",value:b}):null]}),m?(0,t.jsxs)("details",{style:{marginTop:10},children:[(0,t.jsx)("summary",{style:{cursor:"pointer",fontSize:12,opacity:.7},children:"パス"}),(0,t.jsx)("div",{style:{fontSize:11,opacity:.6,marginTop:6,wordBreak:"break-all"},children:m})]}):null]})}function s(e){let{label:r,value:i}=e;return(0,t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"72px 1fr",gap:10,minWidth:0},children:[(0,t.jsx)("div",{style:{fontSize:11,opacity:.55,whiteSpace:"nowrap"},children:r}),(0,t.jsx)("div",{style:{fontSize:12,opacity:.85,minWidth:0,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},title:i,children:i})]})}function d(e){return{width:44,height:34,borderRadius:999,border:"1px solid var(--panel-border)",background:"var(--panel-hover)",color:"white",fontWeight:900,opacity:e?.45:1,cursor:e?"not-allowed":"pointer",display:"grid",placeItems:"center",lineHeight:1}}function c(e){return{width:40,height:32,borderRadius:999,border:"1px solid var(--panel-border)",background:"var(--panel)",color:"var(--foreground)",fontWeight:900,opacity:e?.45:1,cursor:e?"not-allowed":"pointer",display:"grid",placeItems:"center",lineHeight:1}}var u=e.i(80389);function p({settingAction:e}){let{settings:r,toggleShowFilePath:i,toggleContinuous:l,toggleShuffle:n}=(0,u.useSettings)(),a=r.ui.showFilePath,o=r.playback.continuous,s=r.playback.shuffle;return(0,t.jsxs)("div",{className:"grid gap-4",children:[(0,t.jsx)(g,{onClick:e.pickFolderAndLoad,children:"フォルダを選ぶ"}),e.savedHandle&&e.needsReconnect?(0,t.jsx)(g,{onClick:e.reconnect,variant:"ghost",children:"再接続"}):null,(0,t.jsx)(f,{children:"再生"}),(0,t.jsx)(h,{label:"連続再生",checked:o,onChange:l}),(0,t.jsx)(h,{label:"シャッフル",checked:s,onChange:n}),(0,t.jsx)(f,{children:"表示"}),(0,t.jsx)(h,{label:"file名",checked:a,onChange:i}),e.savedHandle?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(f,{children:"危険操作"}),(0,t.jsx)(g,{onClick:()=>{window.confirm("保存しているフォルダの記憶を消します。よろしいですか？")&&e.forget()},variant:"danger",children:"記憶を消す"})]}):null,(0,t.jsx)(f,{children:"ライブラリ"}),(0,t.jsx)(g,{children:"すべて"}),(0,t.jsx)(g,{children:"対応表あり"}),(0,t.jsx)(g,{children:"対応表なし"}),(0,t.jsx)(f,{children:"ソート"}),(0,t.jsx)(g,{children:"Fantia順"}),(0,t.jsx)(g,{children:"ファイル名順"})]})}function f({children:e}){return(0,t.jsx)("div",{className:"text-sm font-extrabold opacity-90",children:e})}function h(e){return(0,t.jsxs)("label",{className:"flex items-center justify-between gap-3 px-1 select-none cursor-pointer",children:[(0,t.jsx)("span",{className:"text-sm opacity-90 whitespace-nowrap",children:e.label}),(0,t.jsxs)("span",{style:{position:"relative",width:44,height:24,borderRadius:999,border:"1px solid var(--toggle-border)",background:e.checked?"var(--toggle-track-on)":"var(--toggle-track-off)",transition:"background 120ms ease",flex:"0 0 auto"},children:[(0,t.jsx)("input",{type:"checkbox",checked:e.checked,onChange:e.onChange,style:{position:"absolute",inset:0,opacity:0,cursor:"pointer"},"aria-label":`${e.label} の切り替え`}),(0,t.jsx)("span",{style:{position:"absolute",top:3,left:e.checked?22:3,width:18,height:18,borderRadius:999,background:"var(--toggle-knob)",boxShadow:"0 2px 8px var(--toggle-knob-shadow)",transition:"left 120ms ease"}})]})]})}function g(e){let r=e.variant??"normal",i="text-left px-3 py-2 rounded-lg border transition",l="danger"===r?`${i} bg-transparent border-[color:rgba(255,99,99,0.45)] text-[color:rgb(255,170,170)] hover:bg-[color:rgba(255,99,99,0.10)]`:"ghost"===r?`${i} bg-transparent border-[color:var(--panel-border)] text-[color:var(--foreground)] hover:bg-[color:var(--panel-hover)]`:`${i} bg-[color:var(--panel)] border-[color:var(--panel-border)] text-[color:var(--foreground)] hover:bg-[color:var(--panel-hover)]`;return(0,t.jsx)("button",{type:"button",className:l,onClick:e.onClick,children:e.children})}function m(e){let{title:r,settingAction:i}=e;return(0,t.jsx)("header",{style:{marginTop:8,padding:"10px 12px",borderRadius:14,border:"1px solid var(--panel-border)",background:"var(--panel)",color:"var(--foreground)"},children:(0,t.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12,flexWrap:"wrap"},children:(0,t.jsxs)("div",{style:{display:"flex",alignItems:"baseline",gap:10,minWidth:220,flex:"1 1 auto"},children:[(0,t.jsx)("div",{style:{fontSize:20,fontWeight:900,lineHeight:1.1,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:320},title:r,children:r}),(0,t.jsx)("span",{style:{fontSize:12,color:"var(--muted)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:360},title:i.folderName,children:i.folderName?`選択中: ${i.folderName}`:"未選択"})]})})})}function y({settingAction:e}){let r=!!(e.savedHandle&&e.needsReconnect);return(0,t.jsxs)("div",{style:{display:"grid",placeItems:"center",padding:16},children:[r?(0,t.jsxs)("button",{type:"button",style:{width:"min(640px, 100%)",borderRadius:18,border:"1px solid var(--panel-border)",background:"var(--panel)",padding:22,textAlign:"center",marginBottom:16},onClick:()=>void e.reconnect(),children:[(0,t.jsx)("div",{style:{fontSize:18,fontWeight:900,marginBottom:10},children:"再接続"}),(0,t.jsx)("div",{style:{opacity:.75,fontSize:13,marginBottom:18},children:"以前に開いたフォルダを再読み込みします"})]}):null,(0,t.jsxs)("button",{type:"button",onClick:()=>void e.pickFolderAndLoad(),style:{width:"min(640px, 100%)",borderRadius:18,border:"1px solid var(--panel-border)",background:"var(--panel)",padding:22,textAlign:"center",marginBottom:16},children:[(0,t.jsx)("div",{style:{fontSize:18,fontWeight:900,marginBottom:10},children:"フォルダをを選んで開く"}),(0,t.jsx)("div",{style:{opacity:.75,fontSize:13,marginBottom:18},children:"このアプリはローカルフォルダを読み込んで曲一覧を表示します。"})]}),(0,t.jsxs)("div",{role:"note",style:{width:"min(640px, 100%)",borderRadius:16,border:"1px solid var(--warn-border)",background:"var(--warn-bg)",padding:"14px 16px",position:"relative",overflow:"hidden"},children:[(0,t.jsx)("div",{"aria-hidden":!0,style:{position:"absolute",left:0,top:0,bottom:0,width:6,background:"var(--warn-bar)",opacity:1}}),(0,t.jsxs)("div",{style:{minWidth:0},children:[(0,t.jsx)("div",{style:{fontSize:16,fontWeight:900,lineHeight:1.2,color:"var(--warn-title)"},children:"⚠️ 読み込みに少し時間がかかることがあります"}),(0,t.jsx)("div",{style:{marginTop:6,fontSize:15,color:"var(--warn-text)",lineHeight:1.5},children:"曲数やジャケット画像の数が多いほど時間がかかります。固まって見えても数秒お待ちください。"})]})]})]})}var b=e.i(18613);function v(e){let{isPaused:r=!1,children:i}=e;return(0,t.jsxs)("span",{className:`${b.default.npRing}${r?` ${b.default.isPaused}`:""}`,"aria-hidden":"true",children:[i,Array.from({length:12}).map((e,r)=>(0,t.jsx)("span",{},r))]})}function x(e){let{view:r,index:i,isActive:l,isPlaying:a,onPlay:o}=e,s=()=>{o(i)};return(0,t.jsxs)("tr",{onClick:s,onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),s())},role:"button",tabIndex:0,"aria-label":`再生: ${r.displayTitle}`,style:{cursor:"pointer",userSelect:"none",touchAction:"manipulation",background:l?"rgba(0,0,0,0.06)":"transparent"},className:"hover:bg-black/5 active:bg-black/10",children:[(0,t.jsx)("td",{style:{...w,padding:0},children:(0,t.jsx)("div",{style:{display:"grid",placeItems:"center"},children:(0,t.jsx)("div",{style:{height:20,width:28,padding:0,borderRadius:999,border:l?"1px solid var(--list-action-border-active)":"1px solid var(--list-action-border)",background:l?"var(--list-action-bg-active)":"transparent",color:"var(--foreground)",fontWeight:800,lineHeight:"20px",display:"inline-flex",alignItems:"center",justifyContent:"center"},title:"この曲を再生",children:l?a?(0,t.jsx)(v,{}):"⏸":"▶"})})}),(0,t.jsx)("td",{style:{padding:"auto",textAlign:"right"},children:i+1}),(0,t.jsx)("td",{style:{...w,padding:0,borderLeft:"3px solid transparent"},children:(0,t.jsx)("div",{style:{width:20,height:20,borderRadius:8,overflow:"hidden",border:"1px solid var(--list-chip-border)",background:"var(--list-chip-bg)",display:"grid",placeItems:"center"},children:r.coverUrl?(0,t.jsx)(n.default,{src:r.coverUrl,alt:"",width:20,height:20,unoptimized:!0,style:{width:"100%",height:"100%",objectFit:"cover"}}):(0,t.jsx)("span",{style:{border:"1px solid var(--no-fg)",fontSize:14,fontWeight:900,letterSpacing:"0.02em",color:"var(--no-fg)",background:"var(--no-bg)",borderRadius:6,padding:"1px 4px",lineHeight:1.1},"aria-label":"ジャケットなし",title:"ジャケットなし",children:r.orderLabel??r.originalArtist??"No"})})}),(0,t.jsx)("td",{style:w,children:(0,t.jsx)("div",{style:{...j,fontWeight:a?950:j.fontWeight,textShadow:a?"0 1px 0 var(--panel-hover)":"none"},title:r.displayTitle,children:r.displayTitle})}),(0,t.jsx)("td",{style:w,children:(0,t.jsx)("div",{style:_,title:r.orderLabel,children:r.orderLabel})}),(0,t.jsx)("td",{style:w,children:(0,t.jsx)("div",{style:_,title:r.originalArtist||"—",children:r.originalArtist||"—"})})]})}let w={padding:"0 6px",verticalAlign:"middle",lineHeight:"24px"},j={fontSize:14,fontWeight:900,lineHeight:"24px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},_={fontSize:12,opacity:.75,lineHeight:1.1,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"};function S(e){let{trackViews:i,playActions:l,nowPlayingID:n,isPlaying:a,settingAction:o}=e,s=(0,r.useRef)(null),{settings:d}=(0,u.useSettings)(),c=d.ui.showFilePath;return(0,r.useEffect)(()=>{if(!n)return;let e=s.current;e&&e.scrollIntoView({behavior:window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches?"auto":"smooth",block:"nearest",inline:"nearest"})},[n]),o.folderName?0===i.length?(0,t.jsx)(t.Fragment,{children:"読み込み中"}):(0,t.jsx)("section",{children:(0,t.jsx)("div",{"data-scroll":"song-list",style:{maxWidth:"100%",overflowX:c?"auto":"hidden"},children:(0,t.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",tableLayout:"fixed"},children:[(0,t.jsx)("colgroup",{children:[(0,t.jsx)("col",{style:{width:32}},"action"),(0,t.jsx)("col",{style:{width:28}},"no"),(0,t.jsx)("col",{style:{width:28}},"art"),(0,t.jsx)("col",{},"title"),(0,t.jsx)("col",{style:{width:"clamp(80px, 9vw, 120px)"}},"ym"),(0,t.jsx)("col",{style:{width:"clamp(60px, 9vw, 100px)"}},"orig"),...c?[(0,t.jsx)("col",{style:{width:260}},"path")]:[]]}),(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{style:{borderBottom:"1px solid var(--list-border)"},children:[(0,t.jsx)("th",{style:{...C,textAlign:"right"}}),(0,t.jsx)("th",{style:C,children:"#"}),(0,t.jsx)("th",{style:C,"aria-label":"ジャケット"}),(0,t.jsx)("th",{style:C,children:"曲名"}),(0,t.jsx)("th",{style:C,children:"アルバム"}),(0,t.jsx)("th",{style:C,children:"原曲"}),c?(0,t.jsx)("th",{style:C,children:"ファイル"}):null]})}),(0,t.jsx)("tbody",{children:i.map((e,r)=>(0,t.jsx)(x,{view:e,index:r,isActive:n===e.item.id,isPlaying:a,onPlay:l.playAtIndex},r))})]})})}):(0,t.jsx)(y,{settingAction:o})}let C={padding:"2px 6px",fontSize:11,fontWeight:800,opacity:.85,textAlign:"left",whiteSpace:"nowrap"};e.i(27171);let P=e=>{let t=e.trim(),r=/^(\d{4})[\/-](\d{1,2})$/.exec(t);if(!r)return null;let i=Number(r[1]),l=Number(r[2]);if(!Number.isInteger(i)||!Number.isInteger(l)||l<1||l>12)return null;let n=String(l).padStart(2,"0");return{year:i,month:l,normalized:`${i}-${n}`}},k=(e,t)=>{let r=e.trim();if(!r||r.startsWith("#"))return null;let i=r.split(t),l=(i[0]??"").trim(),n=(i[1]??"").trim(),a=(i[2]??"").trim(),o=(i[3]??"").trim();return n&&a?{prefixId:l||null,releaseYm:n,title:a,originalArtist:o||null}:null},R=async e=>{let t=await fetch(e,{cache:"no-store"});if(!t.ok)throw Error(`対応表の読み込みに失敗しました: ${t.status} ${t.statusText}`);let r=await t.arrayBuffer();return new TextDecoder("utf-8").decode(r)},E=async(e="fantia-mapping.tsv")=>{let t="/mp3-song-info-editor".replace(/\/$/,""),r=`${t}/data/${e}`;return(e=>{let t=e.split(/\r?\n/),r=(t.find(e=>e.trim()&&!e.trim().startsWith("#"))??"").includes("	")?"	":",",i=[];for(let e of t){let t=k(e,r);t&&i.push(t)}let l=new Map,n=[];for(let e of i){let t=P(e.releaseYm);if(!t)continue;let{year:r,month:i,normalized:a}=t,o=(l.get(a)??0)+1;l.set(a,o);let s=10*i+o;n.push({...e,releaseYm:a,year:r,month:i,withinMonthIndex:o,track:s})}return n})(await R(r))},A="mp3-song-info-editor",L="handles",O="musicDir",I=1,N=new Set(["jpg","jpeg","png","gif"]),W=()=>{let e=(0,r.useRef)(new Map),[t,i]=(0,r.useState)({}),l=()=>{for(let t of e.current.values())URL.revokeObjectURL(t);e.current.clear(),i({})};return(0,r.useEffect)(()=>l,[]),{urlByKey:t,setUrl:(t,r)=>{let l=e.current.get(t);l&&URL.revokeObjectURL(l),r?e.current.set(t,r):e.current.delete(t),i(e=>({...e,[t]:r}))},clearAll:l}},z=async(e,t,r)=>{let i=[...e],l=async()=>{for(;i.length>0;){let e=i.shift();if(!e)return;await r(e)}},n=Math.max(1,t);await Promise.all(Array.from({length:n},l))},M=()=>new Promise((e,t)=>{let r=indexedDB.open(A,I);r.onupgradeneeded=()=>{let e=r.result;e.objectStoreNames.contains(L)||e.createObjectStore(L)},r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)}),T=async e=>{let t=await M();await new Promise((r,i)=>{let l=t.transaction(L,"readwrite");l.objectStore(L).put(e,O),l.oncomplete=()=>r(),l.onerror=()=>i(l.error)})},$=async()=>{let e=await M();return await new Promise((t,r)=>{let i=e.transaction(L,"readonly").objectStore(L).get(O);i.onsuccess=()=>t(i.result??null),i.onerror=()=>r(i.error)})},D=async()=>{let e=await M();await new Promise((t,r)=>{let i=e.transaction(L,"readwrite");i.objectStore(L).delete(O),i.oncomplete=()=>t(),i.onerror=()=>r(i.error)})},B=async(e,t)=>{let r=[];for await(let[i,l]of e){let e=t?`${t}/${i}`:i;if("file"===l.kind){if(!i.toLowerCase().endsWith(".mp3")&&!i.toLowerCase().endsWith(".m4a"))continue;let t=await l.getFile();r.push({id:0,path:e,name:t.name,size:t.size,lastModified:t.lastModified,fileHandle:l});continue}if("directory"===l.kind){let t=await B(l,e);r.push(...t)}}return r.map((e,t)=>({...e,id:t+1}))},U=(e,t)=>{let r=new Uint8Array([...e].map(e=>255&e.charCodeAt(0)));return new TextDecoder(t,{fatal:!1}).decode(r)},F=e=>{let t,r,i=e.replace(/\u0000/g,"").trim();if(0===i.length||(t=/[\u0080-\u00FF]/.test(i),r=/[\u3040-\u30FF\u3400-\u9FFF]/.test(i),!t||r))return i;try{let e=U(i,"shift_jis").trim();if(e)return e}catch{}try{let e=U(i,"utf-8").trim();if(e)return e}catch{}return i},H=(e,t)=>{let r=t.native;if(r)for(let t of["ID3v2.3","ID3v2.4","ID3v2.2","ID3v1"]){let i=r[t];if(i)for(let t of e){let e=i.find(e=>e.id===t);if(!e)continue;let r=e.value;if("string"==typeof r){let e=F(r);if(e)return e}if(Array.isArray(r)){let e=r.find(e=>"string"==typeof e&&e.trim());if("string"==typeof e){let t=F(e);if(t)return t}}}}},V=async t=>{let{parseBlob:r}=await e.A(8765),i=await r(t,{duration:!1}),l=i.common,n=l.picture?.[0];return{title:H(["TIT2","TT2"],i)??l.title,artist:H(["TPE1","TP1"],i)??l.artist??l.artists?.join(", "),album:H(["TALB","TAL"],i)??l.album,trackNo:l.track?.no??void 0,year:l.year??void 0,picture:n?{data:n.data,format:n.format}:void 0}},Z=e=>{let t=e.lastIndexOf("/");return t>=0?e.slice(0,t):""},q=e=>{let t=[...e];for(let e=t.length-1;e>0;e--){let r=Math.floor(Math.random()*(e+1));[t[e],t[r]]=[t[r],t[e]]}return t},K=async e=>!e.queryPermission||"granted"===await e.queryPermission({mode:"read"}),G=async e=>!!e.requestPermission&&"granted"===await e.requestPermission({mode:"read"}),X=e=>{let t=e.lastIndexOf(".");return t<0?"":e.slice(t+1).toLowerCase()},Y=async(e,t)=>{if(!t)return e;let r=t.split("/").filter(Boolean),i=e;for(let e of r)i=await i.getDirectoryHandle(e,{create:!1});return i},J=async e=>{let t=[];for await(let[r,i]of e.entries()){if("file"!==i.kind)continue;let e=X(r);N.has(e)&&t.push({name:r,handle:i})}return t[0]?.handle??null},Q=e=>{if("string"!=typeof e)return null;let t=e.trim();return t.length>0?t:null};function ee(){let{settings:e}=(0,u.useSettings)(),[i]=r.default.useState(0),{mp3List:n,covers:s,settingAction:d}=(e=>{let[t,i]=(0,r.useState)([]),[l,n]=(0,r.useState)(""),[a,o]=(0,r.useState)(""),[s,d]=(0,r.useState)(null),[c,u]=(0,r.useState)(!1),[p,f]=(0,r.useState)({}),h=W(),g=W(),m=()=>{o(""),i([]),n(""),f({}),h.clearAll(),g.clearAll()},y=async t=>{n(t.name);let r=await B(t,"");if(e){r=q(r);for(let e=0;e<r.length;e++)r[e].id=e+1}i(r),(async()=>{z(Array.from(new Set(r.map(e=>Z(e.path)))),2,async e=>{try{let r=await Y(t,e),i=await J(r);if(!i)return;let l=await i.getFile(),n=URL.createObjectURL(l);g.setUrl(e,n)}catch{}})})(),z(r,2,async e=>{let t,r=await e.fileHandle.getFile(),i=await V(r),l=(e=>{if(!e)return null;let t=new Blob([e.data.slice().buffer],{type:e.format});return URL.createObjectURL(t)})(i.picture);h.setUrl(e.path,l??null);let n=(t=r.name,{title:i.title??t,artist:i.artist??"",album:i.album??"",trackNo:i.trackNo??null,year:i.year??null,coverUrl:l});f(t=>({...t,[e.path]:n}))})};(0,r.useEffect)(()=>{(async()=>{try{let e=await $();if(!e)return;d(e),n(e.name),await K(e)?(await y(e),u(!1)):u(!0)}catch(e){o(e instanceof Error?e.message:String(e))}})()},[]);let b=async()=>{let e=window.isSecureContext?"function"!=typeof window.showDirectoryPicker?"このブラウザはフォルダ選択に対応していません。Chrome/Edgeでお試しください。":null:"HTTPSで開いてください（セキュアな接続が必要です）。";if(e)return void o(e);m(),u(!1);try{let e=await window.showDirectoryPicker({mode:"read"});await T(e),d(e),await y(e)}catch(e){o(e instanceof Error?e.message:String(e))}},v=async()=>{if(o(""),s){if(!await G(s)){u(!0),o("フォルダへの読み取り権限が付与されませんでした。");return}await y(s),u(!1)}},x=async()=>{await D(),d(null),u(!1),m()};return{mp3List:t,covers:{coverUrlByPath:h.urlByKey,dirCoverUrlByDir:g.urlByKey},settingAction:{folderName:l,errorMessage:a,metaByPath:p,savedHandle:s,needsReconnect:c,pickFolderAndLoad:b,reconnect:v,forget:x}}})(e.playback.shuffle),c=((e,t,i)=>{let[l,n]=r.default.useState(()=>[...e]),a=r.default.useMemo(()=>e.map(e=>e.path).join("\n"),[e]);return r.default.useEffect(()=>{let r=t?q(e):[...e].sort((e,t)=>e.path.localeCompare(t.path,"ja"));n(e=>((e,t)=>{if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r].path!==t[r].path)return!1;return!0})(e,r)?e:r)},[a,e,t,i]),l})(n,e.playback.shuffle,i),{mappingByPrefixId:f,error:h,isLoading:g}=(()=>{let[e,t]=(0,r.useState)([]),[i,l]=(0,r.useState)(""),[n,a]=(0,r.useState)(!0);(0,r.useEffect)(()=>{let e=!1;return(async()=>{try{let r=await E();if(e)return;t(r)}catch(t){if(e)return;l(t instanceof Error?t.message:String(t))}finally{e||a(!1)}})(),()=>{e=!0}},[]);let o=(0,r.useMemo)(()=>{let t=new Map;for(let r of e)r.prefixId&&t.set(r.prefixId.toLowerCase(),r);return t},[e]);return{mapping:e,mappingByPrefixId:o,error:i,isLoading:n}})(),{audioRef:y,nowPlayingID:b,playEntry:v}=(()=>{let e=(0,r.useRef)(null),[t,i]=(0,r.useState)(null),[l,n]=(0,r.useState)(0),a=(0,r.useRef)(null),o=async t=>{let r=e.current;if(!r)return;a.current&&(URL.revokeObjectURL(a.current),a.current=null);let l=await t.fileHandle.getFile(),o=URL.createObjectURL(l);a.current=o,i(o),n(t.id),r.src=o;try{await r.play()}catch{}};return{audioRef:e,audioSrc:t,nowPlayingID:l,playEntry:o}})(),{isPlaying:x}=function(e){let[t,i]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{let t=e.current;if(!t)return;let r=()=>{i(!t.paused&&!t.ended)};return r(),t.addEventListener("play",r),t.addEventListener("pause",r),t.addEventListener("ended",r),()=>{t.removeEventListener("play",r),t.removeEventListener("pause",r),t.removeEventListener("ended",r)}},[e]),{isPlaying:t}}(y),w=(e=>{let{mp3List:t,metaByPath:r,covers:i,mappingByPrefixId:l}=e;return t.map((e,t)=>{let r=e.id;return{item:e,key:r,originalIndex:t}}).map(({item:e},t)=>{var n;let o,s=r[e.path],d=(n=e.path,(o=/(?:^|\/)([0-9a-fA-F]{8})_/.exec(n))?o[1].toLowerCase():null),c=d?l.get(d):void 0,u=a(e.path),p=c?.title??s?.title??u,f=s?.album??null,h=s?.trackNo??null,g=f?h?`${f} / ${String(h).padStart(2,"0")}`:f:null,m=(e=>{if(!e)return null;let t=e.releaseYm.replace("-","/"),r=String(e.withinMonthIndex).padStart(2,"0");return`${t} / ${r}`})(c)??"年月不明",y=Q(s?.artist),b=Q(c?.originalArtist),v=Z(e.path),x=i.coverUrlByPath[e.path]??i.dirCoverUrlByDir[v]??null;return{item:e,index:t,displayTitle:p,orderLabel:g??m,originalArtist:y??b,coverUrl:x}})})({mp3List:c,metaByPath:d.metaByPath,covers:s,mappingByPrefixId:f}),{playActions:j}=(e=>{let{audioRef:t,playEntry:i,trackViews:l,resetKey:n,settings:a}=e,o=(0,r.useRef)(null),s=(0,r.useRef)(!0),d=(0,r.useRef)(!1);(0,r.useEffect)(()=>{s.current=a.playback.continuous,d.current=a.playback.shuffle},[a]);let c=(0,r.useCallback)(async e=>{if(e<0||e>=l.length)return;let t=l[e],r=t.item.name;o.current=e,await i(t.item,r)},[l,i]),u=(0,r.useCallback)(async()=>{let e=o.current;null!==e&&await c(e+1)},[c]),p=(0,r.useCallback)(async()=>{let e=o.current;null!==e&&await c(e-1)},[c]);return(0,r.useEffect)(()=>{let e=t.current;if(!e)return;let r=()=>{s.current&&u()};return e.addEventListener("ended",r),()=>e.removeEventListener("ended",r)},[t,u]),(0,r.useEffect)(()=>{void 0!==n&&(o.current=null)},[n]),(0,r.useEffect)(()=>{let e=e=>{if((e=>{if(!(e instanceof HTMLElement))return!1;let t=e.tagName.toLowerCase();return"input"===t||"textarea"===t||"select"===t||e.isContentEditable})(e.target)||e.ctrlKey||e.metaKey||e.altKey||e.repeat)return;let r=t.current;if(r){if("Space"===e.code){e.preventDefault();let t=r.currentSrc.length>0;if(!r.paused)return void r.pause();if(t){r.ended&&(r.currentTime=0),r.play();return}return void(l.length>0&&c(0))}if("ArrowDown"===e.code){e.preventDefault(),u();return}if("ArrowUp"===e.code){e.preventDefault(),p();return}}};return window.addEventListener("keydown",e,{passive:!1}),()=>window.removeEventListener("keydown",e)},[t,l.length,c,u,p]),(0,r.useMemo)(()=>({playActions:{playAtIndex:c,playNext:u,playPrev:p}}),[c,u,p])})({audioRef:y,playEntry:v,trackViews:w,resetKey:d.folderName,settings:e});return(0,t.jsx)(l,{header:(0,t.jsx)(m,{title:"MP3曲情報エディター",settingAction:d}),sidebar:(0,t.jsx)(p,{settingAction:d}),main:(0,t.jsxs)(t.Fragment,{children:[d.errorMessage?(0,t.jsxs)("p",{style:{color:"crimson"},children:["エラー: ",d.errorMessage]}):null,h?(0,t.jsxs)("p",{style:{color:"crimson"},children:["対応表エラー: ",h]}):null,g?(0,t.jsx)("p",{style:{opacity:.7},children:"対応表読み込み中…"}):null,(0,t.jsx)(S,{trackViews:w,playActions:j,nowPlayingID:b,isPlaying:x,settingAction:d})]}),renderPlayer:e=>(0,t.jsx)(o,{variant:e,nowPlayingID:b,trackViews:w,audioRef:y,playActions:j,isPlaying:x})})}e.s(["default",()=>ee],52683)}]);